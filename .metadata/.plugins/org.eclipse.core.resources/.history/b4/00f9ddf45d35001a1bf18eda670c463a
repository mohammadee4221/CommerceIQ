package tests;


import java.io.*; 
import java.util.*;

import org.openqa.selenium.By;
import org.openqa.selenium.WebElement;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Test;

import com.opencsv.CSVWriter;

import baseTest.baseTest;
import pages.searchPage; 
  
public class ResultGenerator extends baseTest{ 
	searchPage SearchPage;
	
	public ResultGenerator() {
		super();
	}
	
//    private static final String CSV_FILE_PATH 
//        = "C:\\Users\\Fameena\\Desktop\\CommerceIQ\\assisgnment\\TestData\\data.csv"; 

    @BeforeMethod
	public void setUp() throws InterruptedException {				
 
		SearchPage = new searchPage();
		
	}
    
    @Test
    public void addDataToCSV() 
    { 
    	
        //File file = new File(output);  
        boolean nextButt = driver.findElement(By.xpath("(//*[@class=\"lister-page-next next-page\"])[1]")).isEnabled();
        while(!nextButt) {
	        try {  
//	            FileWriter outputfile = new FileWriter(file); 
//	            CSVWriter writer = new CSVWriter(outputfile); 
	        	
	        	String csv = "C:\\Users\\Fameena\\Desktop\\CommerceIQ\\assisgnment\\TestData\\data.csv";
	        	CSVWriter writer = new CSVWriter(new FileWriter(csv));
	  
	            List<String[]> details = new ArrayList<String[]>(); 
	            //List<String> data = new ArrayList<String>(); 
	            for(WebElement name : SearchPage.movieName) {
					(details).add(new String[] {name.getText()});
				}
				
//				for(WebElement year : SearchPage.movieYear) {
//				((Writer) details).append(year.getText());
//				}
//				
//				for(WebElement rating : SearchPage.movieRating) {
//					((Writer) details).append(rating.getText());
//				}

				
				SearchPage.nextButton.click();
				SearchPage.nextButton.isDisplayed();
	  
	            writer.writeAll(details); 
	            writer.close(); 
	        } 
	        catch (IOException e) { 
	            // TODO Auto-generated catch block 
	            e.printStackTrace(); 
	        } 
        }
    } 
} 
